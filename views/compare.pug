extends layout 
block content
    form(action="/compare" method="POST") 
        input(type="text" placeholder="handle 1" name ="handle1" required)
        input(type="text" placeholder="handle 2" name ="handle2" required)
        button(type="submit") Compare 
    if(handle)
        table(border="1" class="container")
                tr 
                    th stats table 
                    th #{handle}
                    th #{Handle}
                tr 
                    td Prolems Tried
                    td #{problemsTried}
                    td #{ProblemsTried}
                tr 
                    td  Problems Solved 
                    td #{problemsSolved}
                    td #{ProblemsSolved}
                tr 
                    td  Contests
                    td #{contestsAttempted}
                    td #{ContestsAttempted}
                tr 
                    td  current rating
                    td #{currentRating}
                    td #{CurrentRating}
                tr 
                    td  max rating
                    td #{maxRating}
                    td #{MaxRating}
                tr 
                    td min rating
                    td #{minRating}
                    td #{MinRating}
                tr 
                    td max up 
                    td #{maxUp}
                    td #{MaxUp}
                tr 
                    td max down 
                    td #{maxDown}
                    td #{MaxDown}
                tr 
                    td best rank
                    td #{bestRank}
                    td #{BestRank}
                tr 
                    td worst rank
                    td #{worstRank}
                    td #{WorstRank}
                tr 
                    td average attempts
                    td #{averageAttempts}
                    td #{AverageAttempts}
        div
            div(class="row")
                div(class="col-8" id="rating" style="width: 900px; height: 500px; ")
                div(class="col-4" id="contest" style="width: 900px; height: 500px; ")
        div
            div(class="row")
                div(class="col-12" id="index" style="width: 900px; height: 500px; ")
        div
            div(class="row")
                div(class="col-12" id="difficulty" style="width: 900px; height: 500px; ")
        div
            div(class="row")
                div(class="col-12" id="tag" style="width: 900px; height: 500px;" )
        br
        table(border="1" class="container")
            tr 
                th common contests and their ranks 
                th #{handle}
                th #{Handle}
            each val,key in compare 
                if (val.length === 3)
                    tr 
                        td 
                            a(href="http://codeforces.com/contest/"+key target="_blank")
                                = val[1].contestName 
                        td 
                            =val[1].rank 
                        td 
                            =val[2].rank
                
                         


        script.
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                var chartData  =[["title",!{JSON.stringify(handle)},!{JSON.stringify(Handle)}]]
                chartData.push(["CurrentRating",#{currentRating},#{CurrentRating}])
                chartData.push(["MaxRating",#{maxRating},#{MaxRating}])
                chartData.push(["MinRating",#{minRating},#{MinRating}])
                var data = google.visualization.arrayToDataTable(chartData);
                var options = {
                    legend: {position: 'top'}
                }
                var chart = new google.visualization.ColumnChart(document.getElementById("rating"));
                chart.draw(data, options);
            }
        script.
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                var chartData  =[["title",!{JSON.stringify(handle)},!{JSON.stringify(Handle)}]]
                chartData.push(["Contests",#{contestsAttempted},#{ContestsAttempted}])
                var data = google.visualization.arrayToDataTable(chartData);
                var options = {
                    legend: {position: 'top'},
                    vAxis:{
                        minValue:0
                    },
                }
                var chart = new google.visualization.ColumnChart(document.getElementById("contest"));
                chart.draw(data, options);
            }

        script.
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            
            
            function drawChart() {
                var index1 = !{JSON.stringify(indexList)}
                var d1 = Array(#{indexCount})
                var index2 = !{JSON.stringify(IndexList)}
                var d2 = Array(#{IndexCount})
                var chartData  =[["Index",!{JSON.stringify(handle)},!{JSON.stringify(Handle)}]]
                var level,ps1,ps2;
                for (let i=0;i<Math.max(d1.length,d2.length);i++)
                {   
                    level = index1[i] || index2[i]
                    ps1 = d1[i] || 0
                    ps2 = d2[i] || 0 
                    if (ps1!=0 || ps2!=0){
                        chartData.push([level,ps1,ps2])
                    }
                        
                }
                var data = google.visualization.arrayToDataTable(chartData);


                var options = {
                    legend: {position: 'top'},
                };
                var chart = new google.visualization.ColumnChart(document.getElementById("index"));
                chart.draw(data, options);
            }

        script.
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            
            
            function drawChart() {
                var difficulty1 = !{JSON.stringify(difficultyList)}
                var d1 = Array(#{difficultyCount})
                var difficulty2 = !{JSON.stringify(DifficultyList)}
                var d2 = Array(#{DifficultyCount})
                var chartData  =[["Difficulty",!{JSON.stringify(handle)},!{JSON.stringify(Handle)}]]
                var difficulty ,ps1,ps2;
                for (let i=0;i<Math.max(d1.length,d2.length);i++)
                {   
                    difficulty  = difficulty1[i] || difficulty2[i]
                    ps1 = d1[i] || 0
                    ps2 = d2[i] || 0 
                    if (ps1!=0 || ps2!=0){
                        chartData.push([difficulty,ps1,ps2])
                    }
                        
                }
                var data = google.visualization.arrayToDataTable(chartData);


                var options = {
                    legend: {position: 'top'},
                };
                var chart = new google.visualization.ColumnChart(document.getElementById("difficulty"));
                chart.draw(data, options);
            }

        script.
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            
            
            function drawChart() {
                var tag1 = !{JSON.stringify(tagList)}
                var d1 = Array(#{tagCount})
                var tag2 = !{JSON.stringify(TagList)}
                var d2 = Array(#{TagCount})
                var chartData  =[["Tag",!{JSON.stringify(handle)},!{JSON.stringify(Handle)}]]
                var tag ,ps1,ps2;
                for (let i=0;i<Math.max(d1.length,d2.length);i++)
                {   
                    tag  = tag1[i] || tag2[i]
                    ps1 = d1[i] || 0
                    ps2 = d2[i] || 0 
                    if (ps1!=0 || ps2!=0){
                        chartData.push([tag ,ps1,ps2])
                    }
                        
                }
                var data = google.visualization.arrayToDataTable(chartData);
                var options = {
                    legend: {position: 'top'},
                };
                var chart = new google.visualization.ColumnChart(document.getElementById("tag"));
                chart.draw(data, options);
            }